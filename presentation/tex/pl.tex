\section[Stückweise Linearisierung]{Stückweise Linearisierung}
\begin{frame}[<+->]
\frametitle{Stückweise Linearisierung}
\begin{itemize}
\item Betrachte nun stückweise lineare Funktionen 
\[
\begin{aligned}
 F&:\R^n \to \R^m, \\
 F&\in \lbrace F_1,\ldots,F_k\rbrace,~F_i(x)=A_ix+b_i~\forall i,~F\text{ global stetig}, \\
 A&\in\R^{m\times n},b\in\R^m
 \end{aligned}
\]
%  \item Betrachte nun $\dot{x} = F(x),~ x_0 = x(0),~F\in C^{0,1}(\R^n)$ (TODO stückweise lineare Funktionen ergänzen)
% \item Es existiert eine Lösung (Filippov)
 \item $F$ ist als \textit{Abs Normal Form} darstellbar $\ldots$
 \end{itemize}
\begin{block}{Abs-Normal Form (\cite{plan})}
 \begin{equation}
\label{eq:absNormalForm}
F(x) = y,\quad 
  \begin{bmatrix}
   z\\y
  \end{bmatrix}
  =
  \begin{bmatrix}
   c\\b
  \end{bmatrix}
  +
  \begin{bmatrix}
   Z & L\\
   J & Y
  \end{bmatrix}
  \begin{bmatrix}
   x\\|z|
  \end{bmatrix}
 \end{equation}
wobei $c\in \R^s, ~ Z\in \R^{s\times n},~ L\in\R^{s\times s}, ~ b\in\R^m, ~ J\in\R^{m\times n}, ~ Y\in \R^{m\times s}$,\\
$s$ \textit{switching depth}, $z\in \R^s$ \textit{switching Variable} und $L$ strikt untere Dreiecksmatrix
\end{block}
\end{frame}

\begin{frame}[<+->]
\frametitle{Stückweise Linearisierung}
\centering
\includegraphics[width=0.65\linewidth]{../dipl_tex/img/tikz/polyhedral_subdevision.pdf}
\end{frame}

\begin{frame}[<+->]
\frametitle{Stückweise Linearisierung}
\begin{itemize}
 \item $\ldots$ und kann benutzt werden, um verkettet stückweise glatte Funktionen 
 \[
 \begin{aligned}
   F&:\R^n \to \R^m, \\
 F&\in \lbrace F_1,\ldots,F_k\rbrace,~F_i(x) \in C^1(\R^n)~\forall i,~F \text{ global stetig}\\
 &\text{verknüpft durch }\abs(\cdot) %\varphi_i \in \lbrace +,*,sin,exp,abs ,\ldots\rbrace                                                                
 \end{aligned}
 \]
an einer Entwicklungsstelle $\xo$ zu approximieren
%  \item Verkettet stückweise glatte Funktionen: stückweise definierte, stetige Funktionen, dessen Auswahlfunktionen stetig differenzierbar sind
% \item Diese Approximation heißt \textit{stückweise Lineariserung} an der Stelle $\xo$ und hat die Form 
% \[
%  F(\xo) + \Delta F(\xo; x-\xo)
% \]
% welche auch als \textit{tangent mode} bezeichnet wird.
\end{itemize}
% \begin{block}{Eigenschaften der Stückweisen Linearisierung}
%  \begin{itemize}
%   \item Blub
%   \item blob
%   \item Blubber
%  \end{itemize}
% \end{block}
\end{frame}

\begin{frame}[<+->]
\frametitle{Stückweise Linearisierung}
\begin{figure}
\centering
% \resizebox{.9\linewidth}{!}{ \input{../dipl_tex/img/piecewise_linearization.tikz} }
\includegraphics[width=0.65\linewidth]{../dipl_tex/img/tikz/piecewise_linearization.pdf}
\end{figure}
\end{frame}

\begin{frame}[<+->]
\frametitle{Stückweise Linearisierung}
\begin{block}{Eigenschaften}
 \begin{itemize}
  \item Approximation 2. Ordnung: \[\|F(x) - F(\xo)- \Delta F(\xo;x-\xo)\| \leq \gamma \|x-\xo\|^2\]
  \item Inkrementfunktion 
    \[\Delta F(\xo;\Delta x) = F'(\xo;\Delta x)~ \text{für } \Delta x \leq \rho(\xo)\]
  
 \end{itemize}
\end{block}
\end{frame}

\begin{frame}[<+->]
\frametitle{Algorithmisches Differenzieren}
\begin{block}{Klassische AD-Regeln}
\[
  \begin{aligned}
    \Delta v_i &= \Delta v_j \pm \Delta v_k & \text{für } v_i = v_j \pm v_k\\
    \Delta v_i &= \vo_j* \Delta v_k +\Delta v_j*\vo_k& \text{für } v_i = v_j * v_k\\
    \Delta v_i &= \mathring c_{ij} * \Delta v_j  & \text{für } v_i = \phi_i(v_j) \not \equiv \abs(v_j)
  \end{aligned}
\]
wobei $\mathring c_{ij} = \phi'_i(\vo_j)$, $\phi_i \in \lbrace sin, cos, sqrt, exp, \ldots,\rbrace$
\end{block}
 \begin{block}{Stückweise Linearisierung}
 Automatische Berechnung der Stückweisen Linearisierung mittels zusätzlicher AD Regel:
 \[
%   \Delta v_i = (v_j \neq 0)?sign(v_j )\Delta v_j : abs(\Delta v_j) \text{ für } v_i = abs(v_j), j\prec i
    \Delta v_i =\abs(v_j + \Delta v_j) - v_i \text{ für } v_i = abs(v_j), j\prec i
 \]
\end{block}
\end{frame}
